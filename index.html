<!DOCTYPE html>
<html lang="en-US">
    <head>
        <title>ethxn</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link id="refsheet" rel="stylesheet" href="resources/css/defaults.css">
    </head>
    <body>
        <div>
            <div>
                <h1 id="heading" class="gradient-text">
                    ethxn.xyz
                </h1>
            </div>
            <div class="theme-changer">
                <div>
                    <img alt="arrow" id="theme-pointer-arrow" class="arrow" src="resources/icons/arrow-down-left.svg" height="50">
                    <p1 id="theme-pointer-text" class="theme-pointer-text">
                        Toggle between<br>light/dark mode!
                    </p1>
                    <p1 id="theme-pointer-hide"class="theme-pointer-hide" onclick="hideThemeCookie()">
                        (hide)
                    </p1>
                </div>
                <p1 class="pardon">
                    Pardon my dust...
                </p1>
                <button id="toggle-theme-button"class="toggle-theme-button">
                    <img alt="moon/sun" id="sun-moon-icon" class="filter-toggle-on" src="resources/icons/sun.svg" height="40">
                </button>
            </div>
            <script>
                const toggleThemeButton = document.getElementById("toggle-theme-button");
                function toggleTheme(){
                    var element = document.body;
                    var eImg = document.getElementById("sun-moon-icon");
                    var eHeading = document.getElementById("heading");
                    var eArrow = document.getElementById("theme-pointer-arrow");

                    element.classList.toggle("dark-body");
                    eImg.classList.toggle("dark-filter-toggle-on");
                    eHeading.classList.toggle("dark-gradient-text");
                    eArrow.classList.toggle("dark-arrow");
                    toggleThemeButton.classList.toggle("dark-toggle-theme-button");
                    
                    if(element.classList.contains("dark-body")){
                        eImg.setAttribute("src", "resources/icons/moon.svg");
                    } else{
                        eImg.setAttribute("src", "resources/icons/sun.svg");
                    }
                }
                if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    toggleTheme();
                }
                toggleThemeButton.addEventListener('click', function(){toggleTheme()});
                document.getElementById("theme-pointer-hide").addEventListener('click', function(){firstTimeCookie()});

                function getCookie(name) {
                    var dc = document.cookie;
                    var prefix = name + "=";
                    var begin = dc.indexOf("; " + prefix);
                    var end = document.cookie.indexOf(";", begin);
                    if (begin == -1) {
                        begin = dc.indexOf(prefix);
                        if (begin != 0) return null;
                    }
                    else
                    {
                        begin += 2;
                        if (end == -1) {
                        end = dc.length;
                        }
                    }
                    return decodeURI(dc.substring(begin + prefix.length, end));
                } 
                function hideThemeArrow(){
                    document.getElementById("theme-pointer-arrow").hidden = true;
                    document.getElementById("theme-pointer-text").hidden = true;
                    document.getElementById("theme-pointer-hide").hidden = true;
                }
                function showThemeArrow(){
                    document.getElementById("theme-pointer-arrow").hidden = false;
                    document.getElementById("theme-pointer-text").hidden = false;
                    document.getElementById("theme-pointer-hide").hidden = false;
                }
                function firstTimeCookie(){
                    var visit=getCookie("themeTipArrowHidden");
                    if (visit==null){
                        showThemeArrow();
                    } else {
                        hideThemeArrow();
                    }
                }
                function hideThemeCookie(){
                    var expire=new Date();
                    expire=new Date(expire.getTime()+7776000000);
                    document.cookie="themeTipArrowHidden=here; expires="+expire + ";path=/";
                    hideThemeArrow();
                }
                firstTimeCookie()
            </script>
        </div>
    </body>
</html>